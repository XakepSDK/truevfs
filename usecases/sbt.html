<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <link href="../css/prettify.css" type="text/css" rel="stylesheet"/>
    <script src="../js/prettify.js" type="text/javascript"></script>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <title>TrueVFS &#x2013; Software Build Tool (SBT)</title>
    <style type="text/css" media="all">
      @import url("../css/site.css");
    </style>
    <link rel="stylesheet" href="../css/print.css" type="text/css" media="print"/>
    <meta name="author" content="Christian Schlichtherle"/>
    <meta name="Date-Revision-yyyymmdd" content="20180601"/>
    <meta http-equiv="Content-Language" content="en"/>
                      <script>
        (function() {
          var cx = '003580521944097984334:8uinm6tpaz4';
          var gcse = document.createElement('script'); gcse.type = 'text/javascript'; gcse.async = true;
          gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
              '//www.google.com/cse/cse.js?cx=' + cx;
          var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(gcse, s);
        })();
      </script>
                                                          
<link rel="alternate" href="http://truevfs.schlichtherle.de/category/announcements/feed/" type="application/rss+xml" title="The TrueZIP Blog - Announcements Feed"/>
                      
  </head>
  <body class="composite" onload="prettyPrint()">
    <div id="banner">
                    <div id="bannerLeft">
                TrueVFS
                </div>
                                <div id="gcse-search-form" class="gcse-searchbox-only"></div>
            <div class="clear"><hr/></div>
    </div>
    <div id="breadcrumbs">
            
                                  <div class="xleft">
        <span id="projectVersion">Version: 0.12.0</span>
                  |                         <a href="../index.html" title="TrueVFS">TrueVFS</a>
      &raquo;
      TrueVFS &#x2013; Software Build Tool (SBT)
              </div>
            <div class="xright">        
                        </div>
      <div class="clear"><hr/></div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
              
                                                   <h5>Documentation</h5>
                  <ul>
                  <li class="none">
                          <a href="../index.html" title="About">About</a>
            </li>
                  <li class="none">
                          <a href="../features.html" title="Key Features">Key Features</a>
            </li>
                                                                                                                                                      <li class="expanded">
                          <a href="../usecases/index.html" title="Use Cases">Use Cases</a>
                    <ul>
                      <li class="none">
            <strong>Software Build Tool</strong>
          </li>
                      <li class="none">
                          <a href="../usecases/se.html" title="Search Engine">Search Engine</a>
            </li>
                      <li class="none">
                          <a href="../usecases/ide.html" title="Integrated Development Environment">Integrated Development Environment</a>
            </li>
                      <li class="none">
                          <a href="../usecases/aff.html" title="Application File Format">Application File Format</a>
            </li>
                      <li class="none">
                          <a href="../usecases/eaff.html" title="Encrypted Application File Format">Encrypted Application File Format</a>
            </li>
              </ul>
        </li>
                                                                                                        <li class="collapsed">
                          <a href="../kick-start/index.html" title="Getting Started">Getting Started</a>
                  </li>
                                                                                                                          <li class="collapsed">
                          <a href="../help.html" title="Getting Help">Getting Help</a>
                  </li>
                  <li class="none">
                          <a href="../concepts.html" title="Basic Concepts">Basic Concepts</a>
            </li>
                  <li class="none">
                          <a href="../glossary.html" title="Glossary">Glossary</a>
            </li>
          </ul>
                       <h5>External Resources</h5>
                  <ul>
                  <li class="none">
                          <a href="http://illegalexception.schlichtherle.de" class="externalLink" title="Christian's Blog">Christian's Blog</a>
            </li>
          </ul>
                       <h5>Parent Module</h5>
                                 <h5>Sub-Modules</h5>
                  <ul>
                  <li class="none">
                          <a href="../truevfs-access/index.html" title="TrueVFS Access">TrueVFS Access</a>
            </li>
                  <li class="none">
                          <a href="../truevfs-access-swing/index.html" title="TrueVFS Access Swing">TrueVFS Access Swing</a>
            </li>
                  <li class="none">
                          <a href="../truevfs-archetype/index.html" title="TrueVFS Archetype">TrueVFS Archetype</a>
            </li>
                  <li class="none">
                          <a href="../truevfs-comp/index.html" title="TrueVFS Component">TrueVFS Component</a>
            </li>
                  <li class="none">
                          <a href="../truevfs-driver/index.html" title="TrueVFS Driver">TrueVFS Driver</a>
            </li>
                  <li class="none">
                          <a href="../truevfs-ext/index.html" title="TrueVFS Extension">TrueVFS Extension</a>
            </li>
                  <li class="none">
                          <a href="../truevfs-it/index.html" title="TrueVFS Integration Tests">TrueVFS Integration Tests</a>
            </li>
                  <li class="none">
                          <a href="../truevfs-kernel/index.html" title="TrueVFS Kernel">TrueVFS Kernel</a>
            </li>
                  <li class="none">
                          <a href="../truevfs-profile/index.html" title="TrueVFS Profile">TrueVFS Profile</a>
            </li>
                  <li class="none">
                          <a href="../truevfs-samples/index.html" title="TrueVFS Samples">TrueVFS Samples</a>
            </li>
          </ul>
                       <h5>Reports</h5>
                  <ul>
                                                                                                                                                                                                                                                                                            <li class="collapsed">
                          <a href="../project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                                      <li class="collapsed">
                          <a href="../project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
                     
<form method="post" action="https://www.paypal.com/cgi-bin/webscr">
  <div class="paypalButton">
    <input name="cmd" type="hidden" value="_s-xclick"/>
    <input name="hosted_button_id" type="hidden" value="AGDEQWWKNZ6UL"/>
    <input src="https://www.paypalobjects.com/en_US/i/btn/btn_donateCC_LG.gif" name="submit" alt="PayPal - The safer, easier way to pay online!" style="border: 0" type="image"/>
  </div>
</form>
                                
                              </div>
    </div>
    <div id="bodyColumn" class="content">
      <div id="contentBox">
                                      <div class="section">
<h2><a name="Software_Build_Tool_SBT"></a>Software Build Tool (SBT)</h2>
<div class="section">
<h3><a name="Motivation"></a>Motivation</h3>
<p>Suppose you're writing a plug-in for the next generation SBT which shall create assemblies of all project artifacts. Then you may need to support at least the following archive types:</p>
<ul>
<li>TAR.GZ</li>
<li>TAR.BZ2</li>
<li>TAR.XZ</li>
<li>ZIP</li>
<li>JAR</li>
<li>WAR</li>
<li>EAR</li>
<li>...</li></ul>
<p>You can easily figure that writing the code to read and write archive files of all these types will be a cumbersome and tedious task because each archive type typically comes with its own API to read and write its archive files. Furthermore, the algorithms required to manage the state transitions required to support arbitrary modifications to an archive file in a thread-safe manner are very complex.</p></div>
<div class="section">
<h3><a name="Copying_Archive_Files"></a>Copying Archive Files</h3>
<p>Thanks to the client API of the module <a href="../truevfs-access/index.html">TrueVFS Access</a>, here's your relief: The <a href="../apidocs/net/java/truevfs/access/TFile.html"><tt>TFile</tt></a> class extends the <tt>java.io.File</tt> class in order to add the required functionality.</p>
<p>See how easy &quot;tarring&quot; a directory can be:</p>
<div class="source">
<pre>new TFile(&quot;directory&quot;).cp_rp(new TFile(&quot;archive.tar.gz&quot;));</pre></div>
<p>The name of the method <tt>TFile.cp_rp(*)</tt> is modeled after the Unix command line <tt>cp -rp</tt> which copies its arguments recursively and preserves all file attributes.</p>
<p>However, in order to prevent ambiguities, unlike the <tt>cp</tt> command line utility, TrueVFS does not support auto-completion of path names or mixing file and directory parameters. So you must provide <i>complete path names</i> for both the source and the destination. E.g. in order to copy a single file to an archive file, you would have to call something like this:</p>
<div class="source">
<pre>new TFile(&quot;file&quot;).cp_rp(new TFile(&quot;archive.tar.gz/file&quot;));</pre></div>
<p>The <tt>TFile</tt> class provides many alternative constructors and methods to ease the tasks of constructing complete path names and copy files or directories - please consult the <a href="../apidocs/net/java/truevfs/access/TFile.html">Javadoc</a> for more information.</p>
<p>The type of the prospective archive file is detected by its extension in a path name. In this case <tt>.tar.gz</tt> was used, but you could use any other registered archive file extension, too (see below). And of course, archive files can not only be used as the destination of a copy method, but also as the source or both. So here's how to unzip a ZIP file to a directory:</p>
<div class="source">
<pre>new TFile(&quot;archive.zip&quot;).cp_rp(new TFile(&quot;directory&quot;));</pre></div>
<p>And here's how to &quot;transform&quot; a ZIP file into a TAR.GZ file:</p>
<div class="source">
<pre>new TFile(&quot;archive.zip&quot;).cp_rp(new TFile(&quot;archive.tar.gz&quot;));</pre></div></div>
<div class="section">
<h3><a name="Customizing_the_Initial_Configuration"></a>Customizing the Initial Configuration</h3>
<p>You may be wondering how TrueVFS gets configured to treat a file name with a <tt>tar.gz</tt> or <tt>zip</tt> extension as a TAR.GZ or ZIP file instead of a plain old file. For now, let it suffice to say that TrueVFS follows the convention-over-configuration principle as much as possible, so there are reasonable defaults for everything in order to relieve you from typical configuration tasks.</p>
<p>For the previous examples to work, the JARs of the driver modules <a href="../truevfs-driver/truevfs-driver-tar/index.html">TrueVFS Driver TAR</a> and <a href="../truevfs-driver/truevfs-driver-zip/index.html">TrueVFS Driver ZIP</a> need to be present on the run time class path. You can do this by adding the Maven artifactId <tt>truevfs-driver-tar</tt> and <tt>truevfs-driver-zip</tt> as a dependency to the POM of your Maven build.</p>
<p>For more information about configuring the client API, please refer to the article <a href="../truevfs-access/configuration.html">Configuring TrueVFS Access</a>.</p>
<div class="section">
<h4><a name="False_Positive_Archive_Files"></a>False Positive Archive Files</h4>
<p>Sometimes a file system entry may have a suffix which is configured to get recognized as an archive file, however the file is not an archive file or not even a file, e.g. a directory. This is called a <i>false positive archive file</i> or <i>false positive</i> for short.</p>
<p>TrueVFS safely detects any false positives and treats them according to their true state, that is, like a plain file or directory. This finding will be remembered until the next call to <tt>TVFS.umount()</tt>, so the performance impact is minimal.</p></div></div>
<div class="section">
<h3><a name="Committing_Changes__Cleaning_Up"></a>Committing Changes / Cleaning Up</h3>
<p>If your application has created or changed one or more archive files, then these changes need to get committed sometime. Even if your application has done read-only acess to the virtual file system, some temporary files may have been created to speed up random access - this dependends on the driver implementation.</p>
<p>If your application is only short-running, then there is actually nothing to do because the TrueVFS Kernel automatically registers and de-registers a JVM shutdown hook which will commit all changes when its run. Note that shutdown hooks are run even if the application terminates due to a <tt>Throwable</tt>.</p>
<p>However, if your application is long running or wants to handle any exceptions, then you may want to manually call this operation - here's how to do this:</p>
<div class="source">
<pre>TVFS.umount();</pre></div>
<p>As a side effect, once this operation succeeded, third parties (e.g. other processes) can safely access the processed archive files until the next time your application starts to operate on them again.</p>
<div class="section">
<h4><a name="Performance_Considerations"></a>Performance Considerations</h4>
<p>Take care not to call <tt>TVFS.umount()</tt> in a loop which updates the same set of archive files because this would result in poor performance in the order of O(n*n) instead of just O(n), where n is the total number of archive entries.</p>
<p>For more information, please refer to the Javadoc for <a href="../apidocs/net/java/truevfs/access/TVFS.html#umount"><tt>TVFS.umount()</tt></a>.</p></div></div></div>
              </div>
    </div>
    <div class="clear"><hr/></div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                    2005-2018
                        <a href="http://schlichtherle.de">Schlichtherle IT Services</a>.
            All Rights Reserved.      
                                   <span id="publishDate">Last Published: 2018-06-01</span>
                        </div>
      <div class="clear"><hr/></div>
    </div>
  </body>
</html>
